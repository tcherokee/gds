---

import qs from 'qs'
import MainLayout from '../../layouts/MainLayout.astro';
import { casinoproviderQs } from "../../../qs/casino-provider"
import fetchApi from '../../../lib/strapi';
import type { Casinoprovider } from "../../../interfaces/casino-provider"
import { get } from 'svelte/store';
import { getTranslations } from '../../../stores/addTranslations';
import IntroBlock from "../../components/blocks/introwithimageblock.astro";

const { slug } = Astro.params; //get the slug from the page url

// Import the QS Query string for custom slugs and prepare it for the API fetch
const query = qs.stringify(casinoproviderQs(slug), {encodeValuesOnly: true})

 // Request to the Fetch Function to get page data from API
const casinoProvider = await fetchApi<Casinoprovider[]>({
	endpoint: 'casino-providers',
    wrappedByKey: 'data',
    query: `?${query}`
})


const translationStore:any = get(getTranslations);

const block = {
    showCasinoFilters: false
}

// breadcrum setup
// let breadcrumbs = [
//     ...data?.layout?.casinoBreadcrumbs,
//     {
//         breadCrumbText: data?.casinoPage?.data?.casino?.data[0]?.attributes?.title,
//         breadCrumbUrl: null
//     }
// ]


---


<MainLayout pageTitle={casinoProvider[0]?.attributes?.seo?.metaTitle}>
    <div class="featured-background">

        <IntroBlock 
            block={casinoProvider[0]?.attributes?.IntroductionWithImage}
            timeDate={casinoProvider[0]?.attributes?.updatedAt}
            authorData={casinoProvider[0]?.attributes?.author} />
    </div>

        <script lang="ts" define:vars={{casinoProvider}}>
		console.log(casinoProvider);
    </script>
</MainLayout>