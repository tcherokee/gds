---
import qs from 'qs'
import fetchApi from '../../../lib/strapi';
import { providerGamesQs } from "../../../qs/provider-games"
import type { Gamepage } from "../../../interfaces/game-page"
import CasinoTable from '../../components/casino/casinoTable.astro';

const { slug } = Astro.props
const query = qs.stringify(providerGamesQs(slug), {encodeValuesOnly: true});

const gamePage = await fetchApi<Gamepage[]>({
    endpoint: 'games',
    wrappedByKey: 'data',
    query: `?${query}`
});

---

<CasinoTable
    casinos={gamePage[0].attributes?.provider?.data?.attributes?.relatedCasinos
        ?.data}
    customPage={true}
/>